# Ruforo Configuration File
# =========================
#
# Copy this file to `config.toml` and customize as needed.
# All values shown are defaults.
#
# Environment variables override config file values.
# Use RUFORO_ prefix, e.g., RUFORO_SITE_NAME, RUFORO_CAPTCHA_PROVIDER
#
# Secrets (passwords, API keys) should be set via environment variables:
#   - RUFORO_CAPTCHA_SECRET_KEY
#   - RUFORO_EMAIL_SMTP_PASSWORD
#   - RUFORO_STORAGE_S3_ACCESS_KEY
#   - RUFORO_STORAGE_S3_SECRET_KEY
#   - DATABASE_URL (standard, no prefix)

# =============================================================================
# Site Settings
# =============================================================================
[site]
name = "Ruforo"
description = "A forum built in Rust"
base_url = "http://localhost:8080"

# =============================================================================
# CAPTCHA Configuration
# =============================================================================
# Supports hCaptcha and Cloudflare Turnstile
# Leave provider empty to disable CAPTCHA
[captcha]
# Provider: "hcaptcha", "turnstile", or "" to disable
provider = ""
# Public site key (safe to put in config file)
site_key = ""
# Secret key - SET VIA ENVIRONMENT VARIABLE: RUFORO_CAPTCHA_SECRET_KEY
# secret_key = ""
# Number of failed logins before CAPTCHA is required
failed_login_threshold = 3

# =============================================================================
# Security Settings
# =============================================================================
[security]
# Maximum failed login attempts before account lockout
max_failed_logins = 5
# Account lockout duration in minutes
lockout_duration_minutes = 15
# Session timeout in minutes (default: 24 hours)
session_timeout_minutes = 1440
# "Remember me" session duration in days
remember_me_days = 30

# =============================================================================
# Rate Limiting
# =============================================================================
[rate_limit]
# Login attempts allowed per window
login_max_attempts = 5
# Login rate limit window in seconds (default: 5 minutes)
login_window_seconds = 300
# Registration attempts per hour per IP
registration_per_hour = 3
# Posts per minute per user
posts_per_minute = 10
# Threads per 5 minutes per user
threads_per_5_minutes = 5

# =============================================================================
# Content Limits
# =============================================================================
[limits]
# Default posts per page
posts_per_page = 25
# Default threads per page
threads_per_page = 20
# Maximum upload size in MB
max_upload_size_mb = 10
# Maximum post length for regular users
max_post_length = 50000
# Maximum post length for moderators
max_post_length_mod = 100000

# =============================================================================
# Email Configuration
# =============================================================================
[email]
smtp_host = "localhost"
smtp_port = 587
smtp_tls = true
smtp_username = ""
# SMTP password - SET VIA ENVIRONMENT VARIABLE: RUFORO_EMAIL_SMTP_PASSWORD
# smtp_password = ""
from_address = "noreply@localhost"
from_name = "Ruforo"

# =============================================================================
# Storage Configuration
# =============================================================================
[storage]
# Backend: "local" for filesystem storage, "s3" for S3-compatible storage
backend = "local"

# Local storage path (used when backend = "local")
local_path = "./uploads"

# S3 settings below only used when backend = "s3"
s3_endpoint = "http://localhost:9000"
s3_region = "us-east-1"
s3_bucket = "ruforo"
s3_public_url = "http://localhost:9000/ruforo"
# S3 credentials - SET VIA ENVIRONMENT VARIABLES:
#   RUFORO_STORAGE_S3_ACCESS_KEY
#   RUFORO_STORAGE_S3_SECRET_KEY
# s3_access_key = ""
# s3_secret_key = ""

# =============================================================================
# Spam Detection
# =============================================================================
[spam]
# Enable spam detection
enabled = true
# Spam score threshold (0.0 - 1.0, higher = more strict)
threshold = 0.7
# Maximum URLs allowed in a post before flagging
max_urls = 5
# Block first posts that contain URLs (strict mode)
block_first_post_urls = false
