// Dark mode styles
// Applied when html.dark class is present

html.dark {
    // Color variables for dark mode
    --bg-primary: #1a1a1a;
    --bg-secondary: #2d2d2d;
    --bg-tertiary: #3a3a3a;
    --text-primary: #e0e0e0;
    --text-secondary: #b0b0b0;
    --text-muted: #808080;
    --border-color: #404040;
    --link-color: #66b3ff;
    --link-hover: #99ccff;
    --button-bg: #404040;
    --button-hover: #505050;
    --header-bg: #222;
    --footer-bg: #1a1a1a;
    --code-bg: #2d2d2d;
    --quote-bg: #2a2a2a;
    --quote-border: #505050;
    --notification-badge-bg: #ff5555;

    // Base styles
    background-color: var(--bg-primary);
    color: var(--text-primary);

    body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
    }

    // Links
    a {
        color: var(--link-color);

        &:hover {
            color: var(--link-hover);
        }
    }

    // Header
    header {
        background-color: var(--header-bg);
        border-bottom: 1px solid var(--border-color);

        .brand {
            color: var(--text-primary);
        }

        .nav-link {
            color: var(--text-secondary);

            &:hover {
                color: var(--text-primary);
                background-color: var(--bg-tertiary);
            }
        }

        .username {
            color: var(--text-primary);
        }
    }

    // Footer
    footer {
        background-color: var(--footer-bg);
        color: var(--text-secondary);
        border-top: 1px solid var(--border-color);
    }

    // Containers
    .struct-container {
        background-color: var(--bg-primary);
    }

    .struct-item {
        background-color: var(--bg-secondary);
        border-color: var(--border-color);

        &:hover {
            background-color: var(--bg-tertiary);
        }
    }

    // Forms
    input[type="text"],
    input[type="password"],
    input[type="email"],
    input[type="search"],
    textarea,
    select {
        background-color: var(--bg-secondary);
        color: var(--text-primary);
        border-color: var(--border-color);

        &:focus {
            background-color: var(--bg-tertiary);
            border-color: var(--link-color);
        }
    }

    button,
    input[type="submit"],
    .button {
        background-color: var(--button-bg);
        color: var(--text-primary);
        border-color: var(--border-color);

        &:hover {
            background-color: var(--button-hover);
        }
    }

    // Tables
    table {
        border-color: var(--border-color);

        th {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        td {
            border-color: var(--border-color);
        }

        tr:hover {
            background-color: var(--bg-tertiary);
        }
    }

    // Code blocks
    code,
    pre {
        background-color: var(--code-bg);
        color: var(--text-primary);
        border-color: var(--border-color);
    }

    // UGC code blocks (posts)
    .ugc {
        pre {
            background: #252525;
            border: 1px solid #444;

            // Language label
            &[data-language]::before {
                color: #666;
                background: rgba(255, 255, 255, 0.05);
            }

            code {
                background: transparent;
            }
        }

        // Inline code
        :not(pre) > code {
            background: #333;
            border-color: #555;
        }
    }

    // Quotes
    blockquote {
        background-color: var(--quote-bg);
        border-left-color: var(--quote-border);
        color: var(--text-secondary);

        &.tagQuote {
            border-color: var(--border-color);

            .quote-link {
                color: var(--text-secondary);
                background: var(--bg-tertiary);

                &:hover {
                    background: var(--quote-border);
                    color: var(--text-primary);
                }
            }

            .attribution {
                color: var(--text-secondary);
            }

            // Nested quotes in dark mode
            blockquote.tagQuote {
                background: var(--bg-tertiary);
            }
        }
    }

    // Messages/Posts
    .message-cell {
        background-color: var(--bg-secondary);
        border-color: var(--border-color);
    }

    .message-userBlock {
        background-color: var(--bg-tertiary);
        border-color: var(--border-color);
    }

    .message-body {
        color: var(--text-primary);
    }

    // Preferences section
    .preferences-section {
        background-color: var(--bg-secondary);
        border-color: var(--border-color);
    }

    // Help text
    .help-text {
        color: var(--text-muted);
    }

    // Forum description
    .forum-description {
        color: var(--text-secondary);
    }

    // Thread meta
    .thread-meta,
    .post-meta {
        color: var(--text-secondary);
    }

    // Notification badge
    .notification-badge {
        background-color: var(--notification-badge-bg);
        color: white;
    }

    // Pagination
    .pagination {
        .page-link {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--border-color);

            &:hover {
                background-color: var(--bg-tertiary);
            }

            &.active {
                background-color: var(--link-color);
                color: white;
            }
        }
    }

    // Stats
    .struct-item-cell--stats {
        dt {
            color: var(--text-muted);
        }

        dd {
            color: var(--text-primary);
        }
    }

    // Recent nav
    .recent-nav-link {
        color: var(--text-secondary);

        &:hover {
            color: var(--text-primary);
            background-color: var(--bg-tertiary);
        }

        &.active {
            color: var(--link-color);
            border-bottom-color: var(--link-color);
        }
    }

    // Post preview
    .post-preview {
        background-color: var(--bg-tertiary);
        border-left-color: var(--border-color);
        color: var(--text-secondary);
    }

    // View post button
    .view-post-btn {
        background-color: var(--link-color);
        color: white;

        &:hover {
            background-color: var(--link-hover);
        }
    }

    // No content messages
    .no-content,
    .no-forums,
    .no-threads {
        color: var(--text-muted);
    }

    // Headings
    h1, h2, h3, h4, h5, h6 {
        color: var(--text-primary);
    }

    // Character Counter
    .char-counter {
        &.char-counter--ok {
            color: #90ee90;
            background-color: #1a3a1a;
            border-color: #2d5a2d;
        }

        &.char-counter--warning {
            color: #ffd966;
            background-color: #3a3a1a;
            border-color: #5a5a2d;
        }

        &.char-counter--danger {
            color: #ff9999;
            background-color: #3a1a1a;
            border-color: #5a2d2d;
        }

        &.char-counter--over {
            color: #ffffff;
            background-color: #dc3545;
            border-color: #bd2130;
        }
    }

    textarea.textarea--over-limit {
        border-color: #dc3545;
        background-color: #2a1a1a;
    }

    // Reactions
    .reaction-badge {
        background: #3a3a3a;
        border-color: #555;

        &:hover {
            background: #454545;
            border-color: #666;
        }

        &.reaction-badge--active {
            background: #1e3a5f;
            border-color: #4a90d9;
        }

        .reaction-count {
            color: #ccc;
        }
    }

    .reaction-picker-toggle {
        background: #3a3a3a;
        border-color: #555;
        color: #aaa;

        &:hover {
            background: #454545;
            border-color: #666;
            color: #fff;
        }
    }

    .reaction-picker-dropdown {
        background: #2a2a2a;
        border-color: #555;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    .reaction-option {
        &:hover {
            background: #454545;
        }

        &.reaction-option--active {
            background: #1e3a5f;
            border-color: #4a90d9;
        }
    }

    // @mention autocomplete
    .mention-dropdown {
        background: #2a2a2a;
        border-color: #555;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    .mention-item {
        &:hover {
            background-color: #3a3a3a;
        }

        &.mention-item--selected {
            background-color: #1e3a5f;
        }
    }

    .mention-username {
        color: #e0e0e0;
    }

    // Recipient autocomplete (for conversations)
    .recipient-dropdown {
        background: #2a2a2a;
        border-color: #555;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    .recipient-item {
        &:hover {
            background-color: #3a3a3a;
        }

        &.recipient-item--selected {
            background-color: #1e3a5f;
        }
    }

    .recipient-username {
        color: #e0e0e0;
    }

    // @mention links in posts
    .ugc a.mention {
        color: #64b5f6;
        background-color: rgba(100, 181, 246, 0.15);

        &:hover {
            background-color: rgba(100, 181, 246, 0.25);
        }
    }

    // Quote button
    .quote-btn {
        background: none;
        border-color: #555;
        color: #aaa;

        &:hover {
            background-color: #3a3a3a;
            border-color: #666;
            color: #fff;
        }

        &:active {
            background-color: #454545;
        }
    }

    // Report button
    .report-btn {
        border-color: #ff6b6b;
        color: #ff6b6b;

        &:hover {
            background: #ff6b6b;
            color: #1a1a1a;
        }
    }

    // Report modal
    .report-modal-content {
        background: #2a2a2a;
        border: 1px solid #444;
    }

    .report-modal-header {
        border-color: #444;

        h3 {
            color: #fff;
        }
    }

    .report-modal-close {
        color: #888;

        &:hover {
            color: #fff;
        }
    }

    .report-form {
        .form-group {
            label {
                color: #e0e0e0;
            }

            select,
            textarea {
                background-color: #333;
                border-color: #555;
                color: #fff;

                &:focus {
                    border-color: #007bff;
                }
            }
        }

        .btn-secondary {
            background: #555;

            &:hover {
                background: #666;
            }
        }
    }

    .report-message {
        &.report-success {
            background: #1a3a1a;
            color: #90ee90;
            border-color: #2d5a2d;
        }

        &.report-error {
            background: #3a1a1a;
            color: #ff9999;
            border-color: #5a2d2d;
        }
    }

    // BBCode Toolbar
    .bbcode-toolbar {
        background: #333;
        border-color: #555;

        button {
            background: #444;
            border-color: #555;
            color: #e0e0e0;

            &:hover {
                background: #555;
                border-color: #666;
            }

            &:active {
                background: #666;
            }
        }
    }

    .toolbar-group {
        border-color: #555;
    }

    .toolbar-group--colors .color-btn {
        &.color-red { border-color: #a71d2a; }
        &.color-green { border-color: #157a3b; }
        &.color-blue { border-color: #0056b3; }
    }

    .bbcode-preview {
        border-color: #555;
        background: #2a2a2a;

        .preview-header {
            background: #333;
            border-color: #555;
            color: #aaa;
        }

        .preview-content {
            color: #e0e0e0;
        }
    }

    // Multi-quote add button
    .add-quote-btn {
        background: none;
        border-color: #555;
        color: #aaa;

        &:hover {
            background-color: #1e3a5f;
            border-color: #4a90d9;
            color: #64b5f6;
        }

        &:active {
            background-color: #2a4a6f;
        }

        &.quote-selected {
            background-color: #2980b9;
            border-color: #3498db;
            color: white;

            &:hover {
                background-color: #c0392b;
                border-color: #e74c3c;
            }
        }
    }

    // Multi-quote floating indicator
    #multi-quote-indicator {
        background: #1a1a1a;
        border: 1px solid #444;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);

        .mq-count {
            color: #e0e0e0;
        }

        .mq-insert {
            background: #27ae60;

            &:hover {
                background: #2ecc71;
            }
        }

        .mq-clear {
            background: #555;

            &:hover {
                background: #e74c3c;
            }
        }
    }

    // Draft indicator
    .draft-indicator {
        color: #aaa;
        background: #3a3a3a;

        &.draft-indicator--restored {
            color: #90ee90;
            background: #1a3a1a;
            border-color: #2d5a2d;
        }
    }

    .draft-clear-btn {
        color: #ff9999;

        &:hover {
            color: #ffcccc;
        }
    }

    // Keyboard shortcuts help modal
    .keyboard-help-content {
        background: #2a2a2a;
        border: 1px solid #444;
    }

    .keyboard-help-header {
        border-color: #444;

        h3 {
            color: #e0e0e0;
        }
    }

    .keyboard-help-close {
        color: #888;

        &:hover {
            color: #fff;
        }
    }

    .shortcut-group h4 {
        color: #aaa;
    }

    .shortcut-row span {
        color: #ccc;
    }

    kbd {
        background: #3a3a3a;
        border-color: #555;
        color: #e0e0e0;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .keyboard-help-footer {
        border-color: #444;
        color: #888;
    }

    // Focused post highlight
    .message.post-focused {
        outline-color: #4a90d9;
        box-shadow: 0 0 0 3px rgba(74, 144, 217, 0.3);
    }

    // Media embeds
    .ugc {
        .video-embed {
            &.video-embed--youtube,
            &.video-embed--vimeo {
                background: #111;
            }

            &.video-embed--direct {
                background: #111;
            }
        }

        // Audio player styling is mostly handled by browser
        // but we can ensure it fits dark mode
        .audio-embed {
            filter: invert(1) hue-rotate(180deg);
        }

        // BBCode Tables
        .bbcode-table {
            tr {
                border-color: #444;
            }

            th, td {
                border-color: #444;
            }

            th {
                background-color: #3a3a3a;
                color: #e0e0e0;
            }

            tr:hover {
                background-color: #333;
            }
        }
    }

    // User info in posts
    .user-title {
        color: #aaa;
    }

    .user-info {
        color: #888;
    }
}
