{% if paginator.has_pages() %}
<nav class="paginated-nav" aria-label="Pagination">
    <div class="pagination" role="list">
        {# Previous button #}
        {% if paginator.this_page > 1 %}
        <a href="{% if paginator.this_page == 2 %}{{ paginator.base_url }}{% else %}{{ paginator.base_url }}page-{{ paginator.this_page - 1 }}{% endif %}" class="page-link page-link--prev" aria-label="Go to previous page">← Previous</a>
        {% else %}
        <span class="page-link page-link--prev page-link--disabled" aria-disabled="true">← Previous</span>
        {% endif %}

        {# First page #}
        {% if paginator.this_page == 1 %}
        <span class="page-link page-link--current" aria-current="page" aria-label="Page 1, current page">1</span>
        {% else %}
        <a href="{{ paginator.base_url }}" class="page-link" aria-label="Go to page 1">1</a>
        {% endif %}

        {# First pages (pages 2-4) #}
        {% let first_pages = paginator.get_first_pages() %}
        {% for page in first_pages %}
        {% if paginator.is_current_page(page) %}
        <span class="page-link page-link--current" aria-current="page" aria-label="Page {{ page }}, current page">{{ page }}</span>
        {% else %}
        <a href="{{ paginator.base_url }}page-{{ page }}" class="page-link" aria-label="Go to page {{ page }}">{{ page }}</a>
        {% endif %}
        {% endfor %}

        {# Ellipsis before inner pages #}
        {% match paginator.get_inner_pages() %}
        {% when Some with (inner_pages) %}
        {% if !inner_pages.is_empty() %}
        <span class="page-link page-link--ellipsis" aria-hidden="true">…</span>

        {# Inner pages (around current page) #}
        {% for page in inner_pages %}
        {% if paginator.is_current_page(page) %}
        <span class="page-link page-link--current" aria-current="page" aria-label="Page {{ page }}, current page">{{ page }}</span>
        {% else %}
        <a href="{{ paginator.base_url }}page-{{ page }}" class="page-link" aria-label="Go to page {{ page }}">{{ page }}</a>
        {% endif %}
        {% endfor %}
        {% endif %}
        {% when None %}{% endmatch %}

        {# Ellipsis before last pages #}
        {% match paginator.get_last_pages() %}
        {% when Some with (last_pages) %}
        {% if !last_pages.is_empty() %}
        <span class="page-link page-link--ellipsis" aria-hidden="true">…</span>

        {# Last pages #}
        {% for page in last_pages %}
        {% if paginator.is_current_page(page) %}
        <span class="page-link page-link--current" aria-current="page" aria-label="Page {{ page }}, current page">{{ page }}</span>
        {% else %}
        <a href="{{ paginator.base_url }}page-{{ page }}" class="page-link" aria-label="Go to page {{ page }}">{{ page }}</a>
        {% endif %}
        {% endfor %}
        {% endif %}
        {% when None %}{% endmatch %}

        {# Next button #}
        {% if paginator.this_page < paginator.page_count %}
        <a href="{{ paginator.base_url }}page-{{ paginator.this_page + 1 }}" class="page-link page-link--next" aria-label="Go to next page">Next →</a>
        {% else %}
        <span class="page-link page-link--next page-link--disabled" aria-disabled="true">Next →</span>
        {% endif %}
    </div>
</nav>

<style>
    .paginated-nav {
        margin: 20px 0;
        display: flex;
        justify-content: center;
    }

    .pagination {
        display: flex;
        gap: 4px;
        align-items: center;
        flex-wrap: wrap;
    }

    .page-link {
        display: inline-block;
        padding: 8px 12px;
        text-decoration: none;
        color: #0066cc;
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        transition: background-color 0.2s, border-color 0.2s;
        font-size: 0.9em;
        min-width: 40px;
        text-align: center;
    }

    .page-link:hover:not(.page-link--current):not(.page-link--disabled):not(.page-link--ellipsis) {
        background-color: #e9ecef;
        border-color: #adb5bd;
    }

    .page-link--current {
        background-color: #0066cc;
        color: white;
        border-color: #0066cc;
        font-weight: bold;
        cursor: default;
    }

    .page-link--disabled {
        color: #6c757d;
        cursor: not-allowed;
        opacity: 0.5;
    }

    .page-link--ellipsis {
        border: none;
        background: none;
        cursor: default;
        pointer-events: none;
        color: #6c757d;
    }

    .page-link--prev,
    .page-link--next {
        font-weight: 500;
    }

    @media (max-width: 768px) {
        .pagination {
            gap: 2px;
        }

        .page-link {
            padding: 6px 10px;
            font-size: 0.85em;
            min-width: 35px;
        }

        .page-link--prev,
        .page-link--next {
            font-size: 0.8em;
        }
    }

    /* Dark mode */
    html.dark .page-link,
    [data-theme="dark"] .page-link {
        color: #6ea8fe;
        background: #2a2a2a;
        border-color: #444;
    }

    html.dark .page-link:hover:not(.page-link--current):not(.page-link--disabled):not(.page-link--ellipsis),
    [data-theme="dark"] .page-link:hover:not(.page-link--current):not(.page-link--disabled):not(.page-link--ellipsis) {
        background-color: #3a3a3a;
        border-color: #555;
    }

    html.dark .page-link--current,
    [data-theme="dark"] .page-link--current {
        background-color: #0d6efd;
        border-color: #0d6efd;
    }

    html.dark .page-link--disabled,
    [data-theme="dark"] .page-link--disabled {
        color: #666;
    }

    html.dark .page-link--ellipsis,
    [data-theme="dark"] .page-link--ellipsis {
        color: #666;
    }

    @media (prefers-color-scheme: dark) {
        html:not([data-theme="light"]) .page-link {
            color: #6ea8fe;
            background: #2a2a2a;
            border-color: #444;
        }

        html:not([data-theme="light"]) .page-link:hover:not(.page-link--current):not(.page-link--disabled):not(.page-link--ellipsis) {
            background-color: #3a3a3a;
            border-color: #555;
        }

        html:not([data-theme="light"]) .page-link--current {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        html:not([data-theme="light"]) .page-link--disabled {
            color: #666;
        }

        html:not([data-theme="light"]) .page-link--ellipsis {
            color: #666;
        }
    }
</style>
{% endif %}
